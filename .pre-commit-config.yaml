repos:
  - repo: local
    hooks:
      - id: check-governed-embeddings
        name: Check for ungoverned embedding calls
        entry: python scripts/check_governed_embeddings.py
        language: system
        pass_filenames: false
        files: '\.py$'
      - id: forbid-sqlite3-connect
        name: Prevent direct sqlite3.connect usage
        entry: python scripts/check_sqlite_connections.py
        language: system
        pass_filenames: true
        files: '\.py$'
      - id: check-static-paths
        name: Prevent static .py path references
        entry: bash -c 'python tools/check_static_paths.py $(git ls-files "*.py")'
        language: system
        pass_filenames: false
      - id: check-dynamic-paths
        name: Ensure dynamic paths use resolve_path
        entry: python tools/check_dynamic_paths.py
        language: system
        pass_filenames: true
        files: '\.py$'
      - id: forbid-stripe-imports
        name: Prevent direct Stripe imports
        entry: python scripts/check_stripe_imports.py
        language: system
        pass_filenames: true
        files: '\.py$'
      - id: forbid-stripe-keys
        name: Prevent Stripe live keys or endpoints
        entry: python scripts/check_stripe_imports.py --keys
        language: system
        pass_filenames: true
        types: [text]
      - id: forbid-raw-stripe-usage
        name: Prevent raw Stripe keys or endpoints
        entry: python scripts/check_raw_stripe_usage.py
        language: system
        pass_filenames: false
        files: '\.py$'
      # Ensure functions that generate prompts always supply a context_builder.
      - id: check-context-builder-usage
        name: Enforce ContextBuilder usage
        entry: python scripts/check_context_builder_usage.py
        language: system
        pass_filenames: false
        files: '\.py$'
  - repo: https://github.com/pycqa/flake8
    rev: 6.1.0
    hooks:
      - id: flake8
