# Default thresholds and per-bot overrides for self-coding workflows.
#
# These values are consumed by ``menace_sandbox.self_coding_thresholds``
# which merges the ``default`` section with any overrides in ``bots``.
# Fields map directly to ``SelfCodingThresholds`` attributes and optional
# forecasting configuration.  The ``stack`` section configures retrieval
# of Stack dataset snippets used during planning.

default:
  roi_drop: -0.1
  error_increase: 1.0
  test_failure_increase: 0.0
  patch_success_drop: -0.2
  roi_weight: 0.5
  error_weight: 0.3
  test_failure_weight: 0.2
  patch_success_weight: 0.1
  auto_recalibrate: true
  model: exponential
  confidence: 0.95
  model_params:
    alpha: 0.3
  test_command:
    - pytest
    - -q
  workflow_tests:
    - tests/workflows/test_default.py::test_smoke

bots:
  QuickFixEngine:
    roi_drop: -0.15
    error_increase: 1.0
    test_failure_increase: 0.0
    patch_success_drop: -0.2
    model: arima
    confidence: 0.9
    model_params:
      order: [1, 1, 1]
    test_command:
      - pytest
      - tests/quickfix
      - -q
    workflow_tests:
      - tests/workflows/test_quickfix.py::test_happy_path

  BotDevelopmentBot:
    roi_drop: -0.1
    error_increase: 1.0
    test_failure_increase: 0.0
    workflow_tests:
      - scripts/run_botdev_workflow.py

  ImplementationOptimiserBot:
    roi_drop: -0.2
    error_increase: 1.5
    test_failure_increase: 0.1
    patch_success_drop: -0.25
    model: exponential
    confidence: 0.9
    test_command:
      - pytest
      - tests/implementation
      - -q

  ResearchAggregatorBot:
    roi_drop: -0.12
    error_increase: 1.2
    test_failure_increase: 0.05
    model: exponential
    confidence: 0.9
    workflow_tests:
      - tests/workflows/test_research.py::test_end_to_end

  AverageMetricBot:
    model: exponential
    confidence: 0.9
    model_params:
      alpha: 0.3

stack:
  enabled: true
  dataset_name: menace-stack
  split: train
  languages:
    - python
    - javascript
  max_lines: 400
  chunk_overlap: 20
  top_k: 10
  weight: 0.5
